import math
import re

def calculate_entropy(password):
    """
    Calculates the Shannon entropy of a password.
    Formula: E = L * log2(R)
    L = Length of the password
    R = Range of possible characters
    """
    if not password:
        return 0

    # Determine the character pool size (R)
    character_pool = 0
    if re.search(r'[a-z]', password): character_pool += 26  # Lowercase
    if re.search(r'[A-Z]', password): character_pool += 26  # Uppercase
    if re.search(r'[0-9]', password): character_pool += 10  # Numbers
    if re.search(r'[^a-zA-Z0-9]', password): character_pool += 32  # Symbols

    # Calculate entropy
    length = len(password)
    entropy = length * math.log2(character_pool)
    return round(entropy, 2)

def evaluate_strength(entropy):
    """Provides a human-readable security rating based on entropy bits."""
    if entropy < 28:
        return "Very Weak (Easily cracked) "
    elif entropy < 40:
        return "Weak (Predictable) "
    elif entropy < 60:
        return "Moderate (Decent) "
    elif entropy < 80:
        return "Strong (Safe) "
    else:
        return "Very Strong (Excellent) "

def main():
    print("--- Password Security Analyzer ---")
    user_password = input("Enter a password to test: ")
    
    bit_strength = calculate_entropy(user_password)
    rating = evaluate_strength(bit_strength)
    
    print(f"\nResults for: {user_password}")
    print(f"Entropy Score: {bit_strength} bits")
    print(f"Security Rating: {rating}")

if _name_ == "_main_":
    main()
